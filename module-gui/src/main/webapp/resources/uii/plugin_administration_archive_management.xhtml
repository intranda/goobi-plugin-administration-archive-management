<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:x="http://myfaces.apache.org/tomahawk"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/compositesPG"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:goobiio="http://goobi.io/facelets"
    xmlns:form="http://xmlns.jcp.org/jsf/composite/forms">
    <composite:interface>
    </composite:interface>
    <composite:implementation>
        <h:head>
            <f:metadata>
                <f:viewParam
                    name="name"
                    value="#{AdministrationForm.administrationPlugin.databaseName}" />
            </f:metadata>
        </h:head>
        <h:panelGroup
            rendered="#{!LoginForm.hasRole('Plugin_Administration_Archive_Management')}"
            styleClass="color-box bg-hot text-white d-flex flex-row p-3">
            <h:outputText
                styleClass="fw-bold"
                value="#{msgs.plugin_administration_missingPermission} Plugin_Administration_Archive_Management" />
        </h:panelGroup>
        <h:panelGroup
            layout="block"
            rendered="#{LoginForm.hasRole('Plugin_Administration_Archive_Management')}">
            <!-- Selection area for a record group to load -->
            <intranda:box
                boxForm="true"
                boxPadding="false"
                boxType="#{AdministrationForm.administrationPlugin.displayMode == '' ? 'primary' : 'action'}"
                icon="fa fa-archive"
                id="selectionBox"
                title="#{AdministrationForm.administrationPlugin.displayMode == 'createArchive'
                    ? msgs.plugin_administration_archive_creationHeading
                    : AdministrationForm.administrationPlugin.displayMode == 'uploadFile'
                    ? msgs.plugin_administration_archive_uploadHeading
                    : msgs.plugin_administration_archive_selectionHeading} "
                rendered="#{AdministrationForm.administrationPlugin.databaseName == NULL}">
                <!-- msgs[AdministrationForm.administrationPlugin.title] -->
                <h:form
                    id="actionform"
                    enctype="multipart/form-data">
                    <h:panelGroup
                        layout="block"
                        rendered="#{AdministrationForm.administrationPlugin.displayMode == ''}">
                        <intranda:formInputDropDown
                            name="selectDB"
                            label="#{msgs.plugin_administration_archive_selectionText}"
                            field="#{AdministrationForm.administrationPlugin.databaseName}"
                            selectItems="#{AdministrationForm.administrationPlugin.possibleDatabases}" />
                        <div class="box__actions">
                            <h:commandLink
                                styleClass="btn btn-blank #{AdministrationForm.administrationPlugin.allowCreation ? '' : 'disabled'}"
                                disabled="#{!AdministrationForm.administrationPlugin.allowCreation}">
                                <h:outputText value="#{msgs.plugin_administration_archive_createNewArchive}" />
                                <f:setPropertyActionListener
                                    value="createArchive"
                                    target="#{AdministrationForm.administrationPlugin.displayMode}" />
                                <f:ajax
                                    render="@form selectionBox:selectionBox"
                                    onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                            </h:commandLink>
                            <h:commandLink
                                styleClass="btn btn-blank #{AdministrationForm.administrationPlugin.allowFileUpload ? '' : 'disabled'}"
                                disabled="#{!AdministrationForm.administrationPlugin.allowFileUpload}">
                                <h:outputText value="#{msgs.plugin_administration_archive_uploadEadFile}" />
                                <f:setPropertyActionListener
                                    value="uploadFile"
                                    target="#{AdministrationForm.administrationPlugin.displayMode}" />
                                <f:ajax
                                    render="@form selectionBox:selectionBox"
                                    onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                            </h:commandLink>
                            <h:commandLink
                                styleClass="btn btn-primary"
                                id="absenden"
                                action="#{AdministrationForm.administrationPlugin.loadSelectedDatabase}">
                                <h:outputText value="#{msgs.plugin_administration_archive_loadDatabase}" />
                            </h:commandLink>
                        </div>
                    </h:panelGroup>
                    <h:panelGroup
                        layout="block"
                        rendered="#{AdministrationForm.administrationPlugin.displayMode == 'createArchive'}">
                        <intranda:formInputText
                            name="filename"
                            label="#{msgs.plugin_administration_archive_creation_filename}"
                            field="#{AdministrationForm.administrationPlugin.databaseName}" />
                        <div class="box__actions">
                            <h:commandLink styleClass="btn btn-blank">
                                <f:setPropertyActionListener
                                    value=""
                                    target="#{AdministrationForm.administrationPlugin.displayMode}" />
                                <f:ajax
                                    render="@form selectionBox:selectionBox"
                                    onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                <h:outputText value="#{msgs.abbrechen}" />
                            </h:commandLink>
                            <h:commandLink
                                styleClass="btn btn-action"
                                action="#{AdministrationForm.administrationPlugin.createNewDatabase}">
                                <h:outputText value="#{msgs.plugin_administration_archive_createNewArchive}" />
                            </h:commandLink>
                        </div>
                    </h:panelGroup>
                    <h:panelGroup
                        layout="block"
                        rendered="#{AdministrationForm.administrationPlugin.displayMode == 'uploadFile'}">
                        <div class="box__actions">
                            <label class="btn btn-blank">
                                <h:outputText value="#{msgs.selectFile}" />
                                <!-- FILE SELECTOR -->
                                <h:inputFile
                                    styleClass="visually-hidden"
                                    value="#{AdministrationForm.administrationPlugin.uploadFile}"
                                    validator="#{AdministrationForm.administrationPlugin.checkExistenceOfSelectedFile}">
                                    <f:ajax
                                        execute="@this"
                                        render="uploadFileButtonGroup"
                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                </h:inputFile>
                            </label>
                            <!-- CANCEL BUTTON -->
                            <h:commandLink styleClass="btn btn-blank">
                                <f:setPropertyActionListener
                                    value=""
                                    target="#{AdministrationForm.administrationPlugin.displayMode}" />
                                <f:ajax
                                    render="@form selectionBox:selectionBox"
                                    onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                <h:outputText value="#{msgs.abbrechen}" />
                            </h:commandLink>
                            <!-- GROUP OF TWO VERSIONS OF THE UPLOAD BUTTON -->
                            <h:panelGroup id="uploadFileButtonGroup">
                                <!-- UPLOAD BUTTON FOR THE CASE WHERE NO SUCH FILE EXISTS YET -->
                                <h:commandLink
                                    styleClass="btn btn-action"
                                    action="#{AdministrationForm.administrationPlugin.upload}"
                                    rendered="#{not AdministrationForm.administrationPlugin.fileToUploadExists}">
                                    <h:outputText value="#{msgs.plugin_administration_archive_uploadDatabase}" />
                                </h:commandLink>
                                <!-- UPLOAD BUTTON FOR THE CASE WHERE AN OLD VERSION OF THE FILE ALREADY EXISTS -->
                                <h:commandLink
                                    styleClass="btn btn-action"
                                    action="#{AdministrationForm.administrationPlugin.upload}"
                                    rendered="#{AdministrationForm.administrationPlugin.fileToUploadExists}"
                                    onclick="if (!confirm('#{msgs.plugin_administration_archive_confirmReplacement}')) return false;">
                                    <h:outputText value="#{msgs.plugin_administration_archive_uploadDatabase}" />
                                </h:commandLink>
                            </h:panelGroup>
                        </div>
                        <!-- // GROUP OF TWO VERSIONS OF THE UPLOAD BUTTON -->
                    </h:panelGroup>
                </h:form>
            </intranda:box>
            <!-- // Selection area for a record group to load -->
            <!-- Edition area for the loaded record group -->
            <h:panelGroup
                id="details"
                layout="block"
                styleclass="row"
                rendered="#{AdministrationForm.administrationPlugin.databaseName != NULL and AdministrationForm.administrationPlugin.displayMode == ''}">
                <h:form
                    styleClass="form-horizontal form-bordered"
                    id="ead-details"
                    prependId="false">
                    <div class="row">
                        <div class="col-12 col-lg-6 pb-2">
                            <intranda:box
                                boxClass="position-sticky top-0"
                                boxType="neutral"
                                boxTitle="false"
                                id="hierarchy">
                                <intranda:boxTitle
                                    title="#{AdministrationForm.administrationPlugin.databaseName}"
                                    icon="fa fa-archive">
                                    <!-- search box -->
                                    <div class="actions d-flex">
                                        <h:commandLink
                                            styleClass="btn d-flex align-items-center btn--title-action search-btn"
                                            id="resetSearch"
                                            action="#{AdministrationForm.administrationPlugin.resetSearch}"
                                            title="#{msgs.clear}">
                                            <span
                                                class="fa fa-undo"
                                                aria-hidden="true" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                        </h:commandLink>
                                        <h:inputText
                                            styleClass="form-control searchfield btn--title-action text-black"
                                            style="min-width: 15rem;"
                                            id="filterField"
                                            value="#{AdministrationForm.administrationPlugin.searchValue}"
                                            onkeypress="submitSearch(event)">
                                        </h:inputText>
                                        <x:commandLink
                                            id="SearchFilter"
                                            forceId="true"
                                            styleClass="btn d-flex align-items-center btn--title-action"
                                            action="#{AdministrationForm.administrationPlugin.search}"
                                            title="#{msgs.search}">
                                            <span
                                                class="fa fa-search"
                                                aria-hidden="true"></span>
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                        </x:commandLink>
                                        <x:commandLink
                                            id="FilterAlle2"
                                            forceId="true"
                                            styleClass="btn d-flex align-items-center btn--title-action"
                                            onclick="$('#advancedSearchBox').modal('show');"
                                            title="#{msgs.plugin_administration_archive_advancedSearch}">
                                            <span
                                                class="fa fa-search-plus"
                                                aria-hidden="true"></span>
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax />
                                        </x:commandLink>
                                    </div>
                                </intranda:boxTitle>
                                <div class="d-flex flex-nowrap justify-content-between">
                                    <div class="scroll-container p-2 w-100">
                                        <div>
                                            <ui:repeat
                                                var="entry"
                                                value="#{AdministrationForm.administrationPlugin.flatEntryList}">
                                                <div
                                                    class="treeView-item py-1"
                                                    style="--level: #{entry.hierarchy};">
                                                    <div class="spacer" />
                                                    <div class="toggle">
                                                        <h:commandLink
                                                            id="expand"
                                                            action="#{AdministrationForm.administrationPlugin.resetFlatList}"
                                                            class="#{entry.displayChildren ? 'expand' : 'expanded'} text-black"
                                                            rendered="#{entry.hasChildren and !entry.displaySearch}">
                                                            <span
                                                                class="#{entry.displayChildren ? 'fa fa-caret-down fa-lg' : 'fa fa-caret-right fa-lg'}"
                                                                aria-hidden="true" />
                                                            <x:updateActionListener
                                                                property="#{entry.displayChildren}"
                                                                value="#{not entry.displayChildren}" />
                                                            <f:ajax
                                                                execute="ead-details"
                                                                render="ead-details"
                                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                        </h:commandLink>
                                                    </div>
                                                    <div class="content">
                                                        <h:commandLink
                                                            id="link2"
                                                            immediate="true"
                                                            styleClass="ps-1 #{entry.selected ? 'fw-700' : ''} #{entry.searchFound ? 'table__structure-link-searched' : ''} #{entry.valid ? '' : 'bg-hot text-white p-1'} #{entry.valid and !entry.selected ? 'text-black' : '' }">
                                                            <span
                                                                class="#{entry.nodeType.icon}"
                                                                aria-hidden="true" />
                                                            <span>
                                                                <h:outputText
                                                                    value="#{entry.label}"
                                                                    rendered="#{entry.label != null}" />
                                                                <h:outputText
                                                                    value=" - "
                                                                    rendered="#{entry.label == null}" />
                                                                <span class="text-secondary">
                                                                    <h:outputText value=" (#{entry.id})" />
                                                                </span>
                                                            </span>
                                                            <ui:fragment rendered="#{entry.goobiProcessTitle != null}">
                                                                <span
                                                                    class="fa fa-cog  margin-left-5"
                                                                    aria-hidden="true" />
                                                            </ui:fragment>

                                                            <ui:fragment rendered="#{entry.childrenHaveProcesses}">
                                                                <span
                                                                    class="fa fa-cog opacity-50 margin-left-5"
                                                                    aria-hidden="true" />
                                                            </ui:fragment>
                                                            <ui:fragment rendered="#{!entry.valid}">
                                                                <span
                                                                    class="fa fa-exclamation-triangle margin-left-5"
                                                                    style="margin-right: 5px;" />
                                                            </ui:fragment>
                                                            <x:updateActionListener
                                                                property="#{AdministrationForm.administrationPlugin.selectedEntry}"
                                                                value="#{entry}" />
                                                            <f:ajax
                                                                execute="ead-details"
                                                                render="hierarchy ead-details globalMessage"
                                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                        </h:commandLink>
                                                    </div>
                                                </div>
                                            </ui:repeat>
                                        </div>
                                    </div>
                                    <fieldSet
                                        jsf:id="buttons"
                                        class="p-2 flex-shrink-1 d-flex flex-column gap-2">
                                        <f:passThroughAttribute
                                            name="#{AdministrationForm.administrationPlugin.readOnlyModus ? 'disabled' :'data-enabled'}"
                                            value="true" />
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600"
                                            action="#{AdministrationForm.administrationPlugin.addNode}"
                                            title="#{msgs.plugin_administration_archive_newNode}">
                                            <span class="fa fa-plus" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600 d-flex flex-nowrap py-2"
                                            onclick="$('#createNodesModal').modal('show');"
                                            disabled="#{AdministrationForm.administrationPlugin.selectedEntry == null}"
                                            title="#{msgs.plugin_administration_archive_addMultipleNodes}">
                                            <span class="fa fa-plus" />
                                            <span class="fa fa-plus" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <x:updateActionListener
                                                property="#{AdministrationForm.administrationPlugin.displayCreateNodesModal}"
                                                value="true" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy createNodesModalContent"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <h:commandLink
                                            styleClass="btn btn-blank"
                                            action="#{AdministrationForm.administrationPlugin.updateGoobiIds}"
                                            title="#{msgs.plugin_administration_archive_removeInvalidProcessIds}">
                                            <span class="fa fa-refresh" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <div
                                            class="d-inline"
                                            title="#{msgs.plugin_administration_archive_createProcesses}"
                                            data-bs-toggle="tooltip">
                                            <button
                                                aria-haspopup="true"
                                                aria-expanded="false"
                                                class="btn btn-primary dropdown-toggle"
                                                data-bs-toggle="dropdown">
                                                <span class="fa fa-files-o"></span>
                                            </button>
                                            <ul class="dropdown-menu dropdown-menu-end">
                                                <ui:repeat
                                                    var="template"
                                                    value="#{AdministrationForm.administrationPlugin.processTemplates}">
                                                    <li>
                                                        <h:commandLink
                                                            action="#{AdministrationForm.administrationPlugin.createProcesses}"
                                                            styleClass="dropdown-item"
                                                            pt:aria-label="#{template.two}">
                                                            <h:outputText value="#{template.two}" />
                                                            <x:updateActionListener
                                                                property="#{AdministrationForm.administrationPlugin.selectedTemplate}"
                                                                value="#{template.one}" />
                                                        </h:commandLink>
                                                    </li>
                                                </ui:repeat>
                                            </ul>
                                        </div>
                                        <h:commandLink
                                            styleClass="btn btn-danger"
                                            action="#{AdministrationForm.administrationPlugin.deleteNode}"
                                            title="#{msgs.plugin_administration_archive_deleteNode}"
                                            onclick="if (!confirm('#{msgs.sollDieserEintragWirklichGeloeschtWerden}')) return false">
                                            <span class="fa fa-trash-o" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy ead-details"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <h:commandLink
                                            styleClass="btn btn-success"
                                            action="#{AdministrationForm.administrationPlugin.validateArchive}"
                                            title="#{msgs.plugin_administration_archive_validate}">
                                            <span class="fa fa-check" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                        </h:commandLink>
                                        <div class="my-auto" />
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600"
                                            action="#{AdministrationForm.administrationPlugin.moveNodeUp}"
                                            title="#{msgs.plugin_administration_archive_moveNodeUp}">
                                            <span class="fa fa-chevron-up" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy globalMessage"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600"
                                            action="#{AdministrationForm.administrationPlugin.moveNodeDown}"
                                            title="#{msgs.plugin_administration_archive_moveNodeDown}">
                                            <span class="fa fa-chevron-down" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy globalMessage"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600"
                                            action="#{AdministrationForm.administrationPlugin.moveHierarchyDown}"
                                            title="#{msgs.plugin_administration_archive_moveHierarchyDown}">
                                            <span class="fa fa-chevron-right" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy globalMessage"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600"
                                            action="#{AdministrationForm.administrationPlugin.moveHierarchyUp}"
                                            title="#{msgs.plugin_administration_archive_moveHierarchyUp}">
                                            <span class="fa fa-chevron-left" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy globalMessage"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                        <!-- move node to another position in separate view -->
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600"
                                            action="#{AdministrationForm.administrationPlugin.prepareMoveNode}"
                                            title="#{msgs.plugin_administration_archive_moveNode}">
                                            <span class="fa fa-arrows" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <x:updateActionListener
                                                property="#{AdministrationForm.administrationPlugin.displayMode}"
                                                value="moveNode" />
                                        </h:commandLink>
                                        <!-- duplicate selected node and insert it as last sibling -->
                                        <h:commandLink
                                            styleClass="btn btn-neutral-600"
                                            onclick="$('#duplicationBox').modal('show');"
                                            title="#{msgs.plugin_administration_archive_duplicateNode}"
                                            
                                            >
                                            <span class="fa fa-files-o" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:ajax
                                                execute="hierarchy"
                                                render="hierarchy globalMessage"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                        </h:commandLink>
                                    </fieldSet>
                                </div>
                                <div class="box__actions pe-2">
                                
                                <h:commandLink
                                        styleClass="btn btn-blank #{AdministrationForm.administrationPlugin.readOnlyModus ? 'disabled' : ''}"
                                        type="submit"
                                        action="#{AdministrationForm.administrationPlugin.eadExport}"
                                        disabled="#{AdministrationForm.administrationPlugin.readOnlyModus}">
                                        <f:passThroughAttribute
                                            name="data-bs-toggle"
                                            value="tooltip" />
                                        <span class="fa fa-globe" />
                                        <span>
                                            <h:outputText value="#{msgs.plugin_administration_archive_eadExport}" />
                                        </span>
                                    </h:commandLink>
                                
                                    <h:commandLink
                                        styleClass="btn btn-blank #{AdministrationForm.administrationPlugin.allowCreation ? '' : 'disabled'}"
                                        action="#{AdministrationForm.administrationPlugin.duplicateEadFile}"
                                        title="#{msgs.plugin_administration_archive_duplicateEadFile}"
                                        disabled="#{!AdministrationForm.administrationPlugin.allowCreation}">
                                        <f:passThroughAttribute
                                            name="data-bs-toggle"
                                            value="tooltip" />
                                        <span class="fa fa-files-o" />
                                        <span>
                                            <h:outputText value="#{msgs.plugin_administration_archive_duplicateEadFile}" />
                                        </span>
                                    </h:commandLink>
                                    <h:commandLink
                                        styleClass="btn btn-blank #{AdministrationForm.administrationPlugin.readOnlyModus ? 'disabled' : ''}"
                                        type="submit"
                                        action="#{AdministrationForm.administrationPlugin.downloadArchive}"
                                        disabled="#{AdministrationForm.administrationPlugin.readOnlyModus}">
                                        <f:passThroughAttribute
                                            name="data-bs-toggle"
                                            value="tooltip" />
                                        <span class="fa fa-download" />
                                        <span>
                                            <h:outputText value="#{msgs.plugin_administration_archive_download}" />
                                        </span>
                                    </h:commandLink>
                                    <h:commandLink
                                        styleClass="btn btn-blank"
                                        type="submit"
                                        action="#{AdministrationForm.administrationPlugin.cancelEdition}">
                                        <f:passThroughAttribute
                                            name="data-bs-toggle"
                                            value="tooltip" />
                                        <h:outputText value="#{msgs.abbrechen}" />
                                    </h:commandLink>
                                </div>
                            </intranda:box>
                        </div>
                        <!-- Right area for loaded node -->
                        <div class="col-12 col-lg-6">
                            <intranda:box
                                boxForm="true"
                                boxPadding="false"
                                boxType="#{AdministrationForm.administrationPlugin.selectedEntry == null ? 'outline' : 'action'}"
                                boxTitle="false"
                                id="nodeBox">
                                <intranda:boxTitle
                                    icon="#{AdministrationForm.administrationPlugin.selectedEntry == null ? 'fa fa-archive' : AdministrationForm.administrationPlugin.selectedEntry.nodeType.icon}"
                                    title="#{AdministrationForm.administrationPlugin.selectedEntry == null
                                            ? msgs.plugin_administration_archive_noElementSelectedHeading
                                            : AdministrationForm.administrationPlugin.selectedEntry.label == null
                                            ? msgs.details
                                            : AdministrationForm.administrationPlugin.selectedEntry.label}">
                                    <div class="actions d-flex">
                                        <button
                                            class="btn d-flex align-items-center btn--title-action"
                                            jsf:id="showAll"
                                            jsf:action="#{AdministrationForm.administrationPlugin.showAllFields}"
                                            jsf:rendered="#{AdministrationForm.administrationPlugin.selectedEntry != null}">
                                            <span class="fa fa-chevron-down" />
                                            <f:ajax
                                                render="nodeBox:nodeContentArea"
                                                onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />                                                
                                            <f:passThroughAttribute
                                                name="data-bs-title"
                                                value="#{msgs.plugin_administration_archive_showAllFields}" />
                                        </button>
                                        <button
                                            class="btn d-flex align-items-center btn--title-action"
                                            jsf:id="saveAndExit"
                                            jsf:action="#{AdministrationForm.administrationPlugin.saveArchiveAndLeave}"
                                            jsf:disabled="#{AdministrationForm.administrationPlugin.readOnlyModus}">
                                            <span class="fa fa-save" />
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                            <f:passThroughAttribute
                                                name="data-bs-title"
                                                value="#{msgs.plugin_administration_archive_saveAndExit}" />
                                        </button>
                                    </div>
                                </intranda:boxTitle>
                                <fieldSet jsf:id="inputArea">
                                    <f:passThroughAttribute
                                        name="#{AdministrationForm.administrationPlugin.readOnlyModus ? 'disabled' :'data-enabled'}"
                                        value="true" />
                                    <div>
                                        <!-- no node selected -->
                                        <h:outputText
                                            rendered="#{AdministrationForm.administrationPlugin.selectedEntry == null}"
                                            styleClass="color-box bg-primary text-white d-flex flex-row p-3"
                                            value="#{msgs.plugin_administration_archive_noElementSelectedText}" />
                                        <!-- // no node selected -->
                                        <!-- a node was selected -->
                                        <h:panelGroup
                                            layout="block"
                                            rendered="#{AdministrationForm.administrationPlugin.selectedEntry != null}"
                                            id="nodeContentArea"
                                            styleClass="form-content">
                                            <div class="processcreation">
                                                <!-- process title -->
                                                <h:panelGroup
                                                    class="form-row"
                                                    id="process-creation-area">
                                                    <div
                                                        class="form-label"
                                                        tabindex="-1">
                                                        <h:outputText value="#{msgs.plugin_administration_archive_process}" />
                                                    </div>
                                                    <div class="form-input">
                                                        <div class="w-100 d-flex flex-nowrap justify-content-between">
                                                            <!-- no process exists, so allow creation of a process here -->
                                                            <ui:fragment
                                                                rendered="#{AdministrationForm.administrationPlugin.selectedEntry.goobiProcessTitle == null}">
                                                                <span class="my-auto">
                                                                    <h:outputText value="#{msgs.plugin_administration_archive_process_no_process}" />
                                                                </span>
                                                                <div
                                                                    class="d-inline"
                                                                    data-bs-title="#{msgs.plugin_administration_archive_process_create_process}"
                                                                    data-bs-toggle="tooltip">
                                                                    <button
                                                                        aria-expanded="false"
                                                                        aria-haspopup="true"
                                                                        aria-label="#{msgs.plugin_administration_archive_process_create_process}"
                                                                        class="btn btn-primary dropdown-toggle"
                                                                        data-bs-toggle="dropdown"
                                                                        type="button">
                                                                        <h:outputText
                                                                            value="#{msgs.plugin_administration_archive_process_create_process}" />
                                                                    </button>
                                                                    <ul class="dropdown-menu dropdown-menu-end">
                                                                        <ui:repeat
                                                                            var="template"
                                                                            value="#{AdministrationForm.administrationPlugin.processTemplates}">
                                                                            <li>
                                                                                <h:commandLink
                                                                                    action="#{AdministrationForm.administrationPlugin.createProcess}"
                                                                                    pt:aria-label="#{template.two}"
                                                                                    styleClass="dropdown-item">
                                                                                    <h:outputText value="#{template.two}" />
                                                                                    <x:updateActionListener
                                                                                        property="#{AdministrationForm.administrationPlugin.selectedTemplate}"
                                                                                        value="#{template.one}" />
                                                                                </h:commandLink>
                                                                            </li>
                                                                        </ui:repeat>
                                                                    </ul>
                                                                </div>
                                                            </ui:fragment>
                                                            <!-- // no process exists, so allow creation of a process here -->
                                                            <!-- process exists -->
                                                            <ui:fragment
                                                                rendered="#{AdministrationForm.administrationPlugin.selectedEntry.goobiProcessTitle != null}">
                                                                <span class="my-auto">
                                                                    <h:outputText
                                                                        value="#{AdministrationForm.administrationPlugin.selectedEntry.goobiProcessTitle}" />
                                                                </span>
                                                                <h:commandLink
                                                                    styleClass="btn btn-blank"
                                                                    action="#{AdministrationForm.administrationPlugin.downloadDocket}"
                                                                    onclick="preventDoubleSubmit(this);">
                                                                    <span class="fa fa-print" />
                                                                    <f:passThroughAttribute
                                                                        name="data-bs-toggle"
                                                                        value="tooltip" />
                                                                    <f:passThroughAttribute
                                                                        name="data-bs-title"
                                                                        value="#{msgs.process_generateDocket}" />
                                                                </h:commandLink>
                                                            </ui:fragment>
                                                            <!-- // process exists -->
                                                        </div>
                                                    </div>
                                                </h:panelGroup>
                                                <!-- //process title -->
                                                <!-- node type as icon -->
                                                <h:panelGroup
                                                    class="form-row"
                                                    id="node-type">
                                                    <div
                                                        class="form-label"
                                                        tabindex="-1">
                                                        <h:outputText value="#{msgs.plugin_administration_archive_nodeType}" />
                                                    </div>
                                                    <div class="form-input">
                                                        <x:dataList
                                                            value="#{AdministrationForm.administrationPlugin.configuredNodes}"
                                                            var="nodeType">
                                                            <h:commandLink
                                                                styleClass="node fs-600 pe-2 my-auto #{AdministrationForm.administrationPlugin.selectedEntry.nodeType.nodeName == nodeType.nodeName ? 'text-black' : 'text-secondary'}"
                                                                title="#{msgs['plugin_administration_archive_nodeType_'.concat(nodeType.nodeName)]}">
                                                                <span
                                                                    class="#{nodeType.icon}"
                                                                    aria-hidden="true" />
                                                                <f:setPropertyActionListener
                                                                    value="#{nodeType}"
                                                                    target="#{AdministrationForm.administrationPlugin.selectedEntry.nodeType}" />
                                                                <f:ajax
                                                                    render="node-type :hierarchy:hierarchy"
                                                                    onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                                <f:passThroughAttribute
                                                                    name="data-bs-toggle"
                                                                    value="tooltip" />
                                                            </h:commandLink>
                                                        </x:dataList>
                                                    </div>
                                                </h:panelGroup>
                                                <!-- // node type as icon -->
                                                <!-- node id -->
                                                <h:panelGroup
                                                    class="form-row"
                                                    id="node-id">
                                                    <div
                                                        class="form-label"
                                                        tabindex="-1">
                                                        <h:outputText value="#{msgs.id}" />
                                                    </div>
                                                    <div class="form-input">
                                                        <h:outputText value="#{AdministrationForm.administrationPlugin.selectedEntry.id}" />
                                                    </div>
                                                </h:panelGroup>
                                            </div>
                                            <!-- Group: Identifikation / Identity Statement Area -->
                                            <h:panelGroup
                                                layout="block"
                                                id="identity-statement-area"
                                                styleClass="d-flex flex-wrap justify-content-between bg-neutral-200">
                                                <h:commandLink
                                                    styleClass="p-2"
                                                    title="#{msgs.plugin_administration_archive_show_details}">
                                                    <span
                                                        class="fa #{AdministrationForm.administrationPlugin.displayIdentityStatementArea?'fa-chevron-down':'fa-chevron-right'}" />
                                                    <span>
                                                        <h:outputText
                                                            styleClass="text-black"
                                                            value="#{msgs.plugin_administration_archive_area_identity}" />
                                                    </span>
                                                    <x:updateActionListener
                                                        property="#{AdministrationForm.administrationPlugin.displayIdentityStatementArea}"
                                                        value="#{not AdministrationForm.administrationPlugin.displayIdentityStatementArea}" />
                                                    <f:ajax
                                                        render="identity-statement-area"
                                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                    <f:passThroughAttribute
                                                        name="data-bs-toggle"
                                                        value="tooltip" />
                                                </h:commandLink>
                                                <goobiio:area
                                                    itemlist="#{AdministrationForm.administrationPlugin.selectedEntry.identityStatementAreaList}"
                                                    area="identicationArea"
                                                    ajaxid="identity-statement-area"
                                                    showDetails="#{AdministrationForm.administrationPlugin.displayIdentityStatementArea}"
                                                    dataVisible="#{AdministrationForm.administrationPlugin.selectedEntry.identityStatementAreaVisible}" />
                                            </h:panelGroup>
                                            <!-- // Group: Identifikation / Identity Statement Area -->
                                            <!-- Group: Kontext / Context Area -->
                                            <h:panelGroup
                                                layout="block"
                                                styleClass="d-flex flex-wrap justify-content-between bg-neutral-200"
                                                id="context-area">
                                                <h:commandLink
                                                    styleClass="p-2"
                                                    title="#{msgs.plugin_administration_archive_show_details}">
                                                    <span
                                                        class="fa #{AdministrationForm.administrationPlugin.displayContextArea?'fa-chevron-down':'fa-chevron-right'}" />
                                                    <span>
                                                        <h:outputText
                                                            styleClass="text-black"
                                                            value="#{msgs.plugin_administration_archive_area_context}" />
                                                    </span>
                                                    <x:updateActionListener
                                                        property="#{AdministrationForm.administrationPlugin.displayContextArea}"
                                                        value="#{not AdministrationForm.administrationPlugin.displayContextArea}" />
                                                    <f:ajax
                                                        render="context-area"
                                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                </h:commandLink>
                                                <goobiio:area
                                                    itemlist="#{AdministrationForm.administrationPlugin.selectedEntry.contextAreaList}"
                                                    area="contextArea"
                                                    ajaxid="context-area"
                                                    showDetails="#{AdministrationForm.administrationPlugin.displayContextArea}"
                                                    dataVisible="#{AdministrationForm.administrationPlugin.selectedEntry.contextAreaVisible}" />
                                            </h:panelGroup>
                                            <!-- // Group: Kontext / Context Area -->
                                            <!-- Group: Inhalt und innere Ordnung / Content and Structure Area -->
                                            <h:panelGroup
                                                layout="block"
                                                styleClass="d-flex flex-wrap justify-content-between bg-neutral-200"
                                                id="content-area">
                                                <h:commandLink
                                                    styleClass="p-2"
                                                    title="#{msgs.plugin_administration_archive_show_details}">
                                                    <span
                                                        class="fa #{AdministrationForm.administrationPlugin.displayContentArea?'fa-chevron-down':'fa-chevron-right'}" />
                                                    <span>
                                                        <h:outputText
                                                            styleClass="text-black"
                                                            value="#{msgs.plugin_administration_archive_area_content}" />
                                                    </span>
                                                    <x:updateActionListener
                                                        property="#{AdministrationForm.administrationPlugin.displayContentArea}"
                                                        value="#{not AdministrationForm.administrationPlugin.displayContentArea}" />
                                                    <f:ajax
                                                        render="content-area"
                                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                </h:commandLink>
                                                <goobiio:area
                                                    itemlist="#{AdministrationForm.administrationPlugin.selectedEntry.contentAndStructureAreaAreaList}"
                                                    area="contentStructureArea"
                                                    ajaxid="content-area"
                                                    showDetails="#{AdministrationForm.administrationPlugin.displayContentArea}"
                                                    dataVisible="#{AdministrationForm.administrationPlugin.selectedEntry.contentAndStructureAreaAreaVisible}" />
                                            </h:panelGroup>
                                            <!-- // Group: Inhalt und innere Ordnung / Content and Structure Area -->
                                            <!-- Group: Zugangs- und Benutzungsbedingungen / Conditions of Access and Use Area -->
                                            <h:panelGroup
                                                layout="block"
                                                styleClass="d-flex flex-wrap justify-content-between bg-neutral-200"
                                                id="access-area">
                                                <h:commandLink
                                                    styleClass="p-2"
                                                    title="#{msgs.plugin_administration_archive_show_details}">
                                                    <span
                                                        class="fa #{AdministrationForm.administrationPlugin.displayAccessArea?'fa-chevron-down':'fa-chevron-right'}" />
                                                    <span>
                                                        <h:outputText
                                                            styleClass="text-black"
                                                            value="#{msgs.plugin_administration_archive_area_access}" />
                                                    </span>
                                                    <x:updateActionListener
                                                        property="#{AdministrationForm.administrationPlugin.displayAccessArea}"
                                                        value="#{not AdministrationForm.administrationPlugin.displayAccessArea}" />
                                                    <f:ajax
                                                        render="access-area"
                                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                </h:commandLink>
                                                <goobiio:area
                                                    itemlist="#{AdministrationForm.administrationPlugin.selectedEntry.accessAndUseAreaList}"
                                                    area="accessArea"
                                                    ajaxid="access-area"
                                                    showDetails="#{AdministrationForm.administrationPlugin.displayAccessArea}"
                                                    dataVisible="#{AdministrationForm.administrationPlugin.selectedEntry.accessAndUseAreaVisible}" />
                                            </h:panelGroup>
                                            <!-- // Group: Zugangs- und Benutzungsbedingungen / Conditions of Access and Use Area -->
                                            <!-- Group: Sachverwandte Unterlagen / Allied Material Area -->
                                            <h:panelGroup
                                                layout="block"
                                                styleClass="d-flex flex-wrap justify-content-between bg-neutral-200"
                                                id="materials-area">
                                                <h:commandLink
                                                    styleClass="p-2"
                                                    title="#{msgs.plugin_administration_archive_show_details}">
                                                    <span
                                                        class="fa #{AdministrationForm.administrationPlugin.displayMaterialsArea?'fa-chevron-down':'fa-chevron-right'}" />
                                                    <span>
                                                        <h:outputText
                                                            styleClass="text-black"
                                                            value="#{msgs.plugin_administration_archive_area_materials}" />
                                                    </span>
                                                    <x:updateActionListener
                                                        property="#{AdministrationForm.administrationPlugin.displayMaterialsArea}"
                                                        value="#{not AdministrationForm.administrationPlugin.displayMaterialsArea}" />
                                                    <f:ajax
                                                        render="materials-area"
                                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                </h:commandLink>
                                                <goobiio:area
                                                    itemlist="#{AdministrationForm.administrationPlugin.selectedEntry.alliedMaterialsAreaList}"
                                                    area="materialsArea"
                                                    ajaxid="materials-area"
                                                    showDetails="#{AdministrationForm.administrationPlugin.displayMaterialsArea}"
                                                    dataVisible="#{AdministrationForm.administrationPlugin.selectedEntry.alliedMaterialsAreaVisible}" />
                                            </h:panelGroup>
                                            <!-- // Group: Sachverwandte Unterlagen / Allied Material Area -->
                                            <!-- Group: Anmerkungen / Note Area -->
                                            <h:panelGroup
                                                layout="block"
                                                styleClass="d-flex flex-wrap justify-content-between bg-neutral-200"
                                                id="notes-area">
                                                <h:commandLink
                                                    styleClass="p-2"
                                                    title="#{msgs.plugin_administration_archive_show_details}">
                                                    <span
                                                        class="fa #{AdministrationForm.administrationPlugin.displayNotesArea?'fa-chevron-down':'fa-chevron-right'}" />
                                                    <span>
                                                        <h:outputText
                                                            styleClass="text-black"
                                                            value="#{msgs.plugin_administration_archive_area_notes}" />
                                                    </span>
                                                    <x:updateActionListener
                                                        property="#{AdministrationForm.administrationPlugin.displayNotesArea}"
                                                        value="#{not AdministrationForm.administrationPlugin.displayNotesArea}" />
                                                    <f:ajax
                                                        render="notes-area"
                                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                </h:commandLink>
                                                <goobiio:area
                                                    itemlist="#{AdministrationForm.administrationPlugin.selectedEntry.notesAreaList}"
                                                    area="notesArea"
                                                    ajaxid="notes-area"
                                                    showDetails="#{AdministrationForm.administrationPlugin.displayNotesArea}"
                                                    dataVisible="#{AdministrationForm.administrationPlugin.selectedEntry.notesAreaVisible}" />
                                            </h:panelGroup>
                                            <!-- // Group: Anmerkungen / Note Area -->
                                            <!-- Group: Verzeichnungskontrolle / Description Control Area -->
                                            <h:panelGroup
                                                layout="block"
                                                styleClass="d-flex flex-wrap justify-content-between bg-neutral-200"
                                                id="control-area">
                                                <h:commandLink
                                                    styleClass="p-2"
                                                    title="#{msgs.plugin_administration_archive_show_details}">
                                                    <span
                                                        class="fa #{AdministrationForm.administrationPlugin.displayControlArea?'fa-chevron-down':'fa-chevron-right'}" />
                                                    <span>
                                                        <h:outputText
                                                            styleClass="text-black"
                                                            value="#{msgs.plugin_administration_archive_area_descriptionControl}" />
                                                    </span>
                                                    <x:updateActionListener
                                                        property="#{AdministrationForm.administrationPlugin.displayControlArea}"
                                                        value="#{not AdministrationForm.administrationPlugin.displayControlArea}" />
                                                    <f:ajax
                                                        render="control-area"
                                                        onevent="(data) => {gwHandleTooltip.init(data); gwInitTooltips.init();}" />
                                                </h:commandLink>
                                                <goobiio:area
                                                    itemlist="#{AdministrationForm.administrationPlugin.selectedEntry.descriptionControlAreaList}"
                                                    area="descriptionArea"
                                                    ajaxid="control-area"
                                                    showDetails="#{AdministrationForm.administrationPlugin.displayControlArea}"
                                                    dataVisible="#{AdministrationForm.administrationPlugin.selectedEntry.descriptionControlAreaVisible}" />
                                            </h:panelGroup>
                                            <!-- // Group: Verzeichnungskontrolle / Description Control Area -->
                                        </h:panelGroup>
                                    </div>
                                    <!-- Button Area on the bottom -->
                                    <div class="box__actions">
                                        <h:commandLink
                                            styleClass="btn btn-success"
                                            id="saveAndExit"
                                            action="#{AdministrationForm.administrationPlugin.saveArchiveAndLeave}">
                                            <span class="fa fa-save" />
                                            <span>
                                                <h:outputText value="#{msgs.plugin_administration_archive_saveAndExit}" />
                                            </span>
                                            <f:passThroughAttribute
                                                name="data-bs-toggle"
                                                value="tooltip" />
                                        </h:commandLink>
                                    </div>
                                    <!-- // Button Area on the bottom -->

                                </fieldSet>

                            </intranda:box>
                        </div>
                        <!-- // Right area for loaded node -->
                    </div>
                </h:form>
            </h:panelGroup>
            <!-- // Edition area for the loaded record group -->
            <!-- Area to move a selected node into another area -->
            <h:panelGroup
                id="moveNodeArea"
                layout="block"
                rendered="#{AdministrationForm.administrationPlugin.databaseName != NULL and AdministrationForm.administrationPlugin.displayMode == 'moveNode'}">
                <intranda:box
                    boxType="action"
                    boxForm="true"
                    boxPadding="false"
                    boxTitle="false">
                    <intranda:boxTitle
                        icon="fa fa-arrows"
                        title="#{msgs.plugin_administration_archive_moveNode}">
                        <div class="actions d-flex">
                            <h:form>
                                <h:commandLink
                                    styleClass="btn d-flex align-items-center btn--title-action"
                                    type="submit">
                                    <x:updateActionListener
                                        property="#{AdministrationForm.administrationPlugin.displayMode}"
                                        value="" />
                                    <h:outputText value="#{msgs.abbrechen}" />
                                </h:commandLink>
                            </h:form>
                        </div>
                    </intranda:boxTitle>
                    <h:form class="p-2">
                        <ui:repeat
                            var="entry"
                            value="#{AdministrationForm.administrationPlugin.moveList}">
                            <div
                                class="treeView-item py-1"
                                style="--level: #{entry.hierarchy};">
                                <div class="spacer" />
                                <div class="toggle" />
                                <div class="content">
                                    <h:commandLink
                                        id="link2"
                                        immediate="true"
                                        styleClass="ps-1 #{entry.selected ? 'fw-700' : 'text-black'}"
                                        action="#{AdministrationForm.administrationPlugin.moveNode}"
                                        disabled="#{entry.selected}">
                                        <span
                                            class="fa fa-file-o"
                                            aria-hidden="true" />
                                        <span>
                                            <h:outputText
                                                value="#{entry.label}"
                                                rendered="#{entry.label != null}" />
                                            <h:outputText
                                                value="#{entry.orderNumber}"
                                                rendered="#{entry.label == null}" />
                                        </span>
                                        <x:updateActionListener
                                            property="#{AdministrationForm.administrationPlugin.destinationEntry}"
                                            value="#{entry}" />
                                    </h:commandLink>
                                </div>
                            </div>
                        </ui:repeat>
                        <div class="box__actions">
                            <h:commandLink
                                styleClass="btn btn-blank"
                                type="submit">
                                <x:updateActionListener
                                    property="#{AdministrationForm.administrationPlugin.displayMode}"
                                    value="" />
                                <h:outputText value="#{msgs.abbrechen}" />
                            </h:commandLink>
                        </div>
                    </h:form>
                </intranda:box>
            </h:panelGroup>
            <!-- // Area to move a selected node into another area -->
            <ui:include src="advancedSearchModal.xhtml" />
            <ui:include src="duplicationModal.xhtml" />
            <ui:include src="linkNodeModal.xhtml" />
            <ui:include src="createNodesModal.xhtml" />
        </h:panelGroup>
        <script>
									function submitSearch(e) {
										if (e.key != 'Enter')
											return

										

																				

										

																														

										

																				

										

																																								

										

																				

										

																														

										

																				

										

										e.preventDefault()
										var submit = document
												.querySelector('[id$="SearchFilter"]');
										submit.click()
									}
								</script>
    </composite:implementation>
</ui:composition>